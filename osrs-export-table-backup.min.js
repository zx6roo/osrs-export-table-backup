javascript:(async()=>{if(typeof XLSX=="undefined"){await new Promise(t=>{const e=document.createElement("script");e.src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js",e.onload=t,document.head.appendChild(e)})}let t=[];try{t=JSON.parse(localStorage.getItem("osrsTableBackup")||"[]")}catch(t){alert("❌ Failed to load collected data.");return}if(!t.length)return void alert("No data found. Did you run the collector on any pages?");const e=[["Page ID","Page Name","URL","Table No","Highlight String"],...t.map(t=>[t.pageId,t.pageName,t.url,t.tableNo,t.highlightString])],n=XLSX.utils.aoa_to_sheet(e),o=XLSX.utils.book_new();XLSX.utils.book_append_sheet(o,n,"All Pages");const r=(new Date).toISOString().slice(0,10),a=`OSRC wiki tables backup ${r}.xlsx`,i=XLSX.write(o,{bookType:"xlsx",type:"array"}),d=new Blob([i],{type:"application/octet-stream"}),c=document.createElement("a");c.href=URL.createObjectURL(d),c.download=a,document.body.appendChild(c),c.click(),setTimeout(()=>{document.body.removeChild(c),URL.revokeObjectURL(c.href)},100)})();
